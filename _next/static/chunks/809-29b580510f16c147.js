"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[809],{604:(e,t,n)=>{n.d(t,{E:()=>a});class a{static getReadableDuration(e){let t=new Date,n=e.getTime()-t.getTime();if(n<=0)return"Expired";let a=Math.floor(Math.floor(n/1e3)/60),r=Math.floor(a/60),i=Math.floor(r/24),o=r%24,s=a%60,c=[];return i>0&&c.push("".concat(i," day").concat(i>1?"s":"")),o>0&&c.push("".concat(o," hour").concat(o>1?"s":"")),s>0&&c.push("".concat(s," minute").concat(s>1?"s":"")),c.join(", ")}static getReadableDurationTrimmed(e){let t=new Date,n=e.getTime()-t.getTime();n<=0&&(n=-n);let a=Math.floor(Math.floor(n/1e3)/60),r=Math.floor(a/60),i=Math.floor(r/24),o=r%24,s=a%60,c=[];return i>0&&c.push("".concat(i," day").concat(i>1?"s":"")),0===i&&o>0&&c.push("".concat(o," hour").concat(o>1?"s":"")),0===i&&(s>0||o>0&&s>5)&&c.push("".concat(s," minute").concat(s>1?"s":"")),0===s&&0===o&&n>0&&c.push("1 minute"),c.join(", ")}static formatTimeDifference(e){let t=new Date,n=e.getTime()-t.getTime();n<=0&&(n=-n);let a=Math.floor(n/864e5),r=Math.floor((n-=864e5*a)/36e5),i=Math.floor((n-=36e5*r)/6e4),o=Math.floor((n-=6e4*i)/1e3),s="";return a>0?s="".concat(a,"d, ").concat(r,"h"):r>0?s="".concat(r,"h, ").concat(i,"m"):i>0&&(s="".concat(i,"m, ").concat(o,"s")),s.trim()}static simpleFormatDate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-GB";return e.toLocaleDateString(t,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}static isPast(e){return e<new Date}static addDays(e,t){let n=new Date(e);return n.setDate(n.getDate()+t),n}}},224:(e,t,n)=>{let a,r;n.d(t,{A:()=>x});let i=(e,t)=>t.some(t=>e instanceof t),o=new WeakMap,s=new WeakMap,c=new WeakMap,l={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return o.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return d(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function d(e){var t;if(e instanceof IDBRequest)return function(e){let t=new Promise((t,n)=>{let a=()=>{e.removeEventListener("success",r),e.removeEventListener("error",i)},r=()=>{t(d(e.result)),a()},i=()=>{n(e.error),a()};e.addEventListener("success",r),e.addEventListener("error",i)});return c.set(t,e),t}(e);if(s.has(e))return s.get(e);let n="function"==typeof(t=e)?(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(u(this),e),d(this.request)}:function(...e){return d(t.apply(u(this),e))}:(t instanceof IDBTransaction&&function(e){if(o.has(e))return;let t=new Promise((t,n)=>{let a=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",i),e.removeEventListener("abort",i)},r=()=>{t(),a()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),a()};e.addEventListener("complete",r),e.addEventListener("error",i),e.addEventListener("abort",i)});o.set(e,t)}(t),i(t,a||(a=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(t,l):t;return n!==e&&(s.set(e,n),c.set(n,e)),n}let u=e=>c.get(e),h=["get","getKey","getAll","getAllKeys","count"],m=["put","add","delete","clear"],y=new Map;function D(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(y.get(t))return y.get(t);let n=t.replace(/FromIndex$/,""),a=t!==n,r=m.includes(n);if(!(n in(a?IDBIndex:IDBObjectStore).prototype)||!(r||h.includes(n)))return;let i=async function(e,...t){let i=this.transaction(e,r?"readwrite":"readonly"),o=i.store;return a&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),r&&i.done]))[0]};return y.set(t,i),i}l=(e=>({...e,get:(t,n,a)=>D(t,n)||e.get(t,n,a),has:(t,n)=>!!D(t,n)||e.has(t,n)}))(l);let w=["continue","continuePrimaryKey","advance"],g={},I=new WeakMap,f=new WeakMap,p={get(e,t){if(!w.includes(t))return e[t];let n=g[t];return n||(n=g[t]=function(...e){I.set(this,f.get(this)[t](...e))}),n}};async function*v(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;let n=new Proxy(t,p);for(f.set(n,t),c.set(n,u(t));t;)yield n,t=await (I.get(n)||t.continue()),I.delete(n)}function b(e,t){return t===Symbol.asyncIterator&&i(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&i(e,[IDBIndex,IDBObjectStore])}l=(e=>({...e,get:(t,n,a)=>b(t,n)?v:e.get(t,n,a),has:(t,n)=>b(t,n)||e.has(t,n)}))(l);class B{static getInstance(){return B.instance||(B.instance=new B),B.instance}async initializeDB(){this.db=await function(e,t,{blocked:n,upgrade:a,blocking:r,terminated:i}={}){let o=indexedDB.open(e,1),s=d(o);return a&&o.addEventListener("upgradeneeded",e=>{a(d(o.result),e.oldVersion,e.newVersion,d(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),s.then(e=>{i&&e.addEventListener("close",()=>i()),r&&e.addEventListener("versionchange",e=>r(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}(this.dbName,0,{upgrade(e){e.objectStoreNames.contains("inventory")||e.createObjectStore("inventory",{keyPath:"name"})}})}async waitForDB(){if(await this.dbReady,!this.db)throw Error("Database is not initialized.")}async getAllItems(e){return await this.waitForDB(),await this.db.getAll(e)}async getAllKeys(e){return await this.waitForDB(),await this.db.getAllKeys(e)}async addItem(e,t){if(await this.waitForDB(),await this.db.get(e,t.name))throw Error("Item already exists in the database");await this.db.put(e,t)}async updateItem(e,t){if(await this.waitForDB(),!await this.db.get(e,t.name))throw Error("Item doesn't exist in the database");await this.db.put(e,t)}async getItemByKey(e,t){return await this.waitForDB(),await this.db.get(e,t)}async deleteItem(e,t){await this.waitForDB(),await this.db.delete(e,t)}constructor(){this.dbName="diabetesMaterialDB",window.indexedDB?this.dbReady=this.initializeDB():(console.warn("IndexedDB is not available in this environment."),this.dbReady=Promise.reject("IndexedDB is not available."))}}let E=B.getInstance();class M{getInventoryItems(){return E.getAllItems("inventory")}async getInventoryItemKeys(){let e=E.getAllKeys("inventory");return(await e).map(e=>e.toString())}storeInventoryItem(e){return E.addItem("inventory",e)}updateInventoryItem(e){return E.updateItem("inventory",e)}deleteInventoryItem(e){return E.deleteItem("inventory",e.name)}getInventoryItem(e){return E.getItemByKey("inventory",e)}getDatesForItem(e){var t;let n=[],a=null!==(t=e.lastUsed)&&void 0!==t?t:new Date;for(let t=1;t<e.quantity;t++)n.push(new Date(a.getTime()+t*e.durationDays*864e5));return n}getNextUseDateForItem(e){var t;return new Date((null!==(t=e.lastUsed)&&void 0!==t?t:new Date).getTime()+864e5*e.durationDays)}getFinalUseDateForItem(e){var t;return new Date((null!==(t=e.lastUsed)&&void 0!==t?t:new Date).getTime()+(e.quantity-1)*e.durationDays*864e5)}getFinalValidDateForItem(e){return new Date(this.getFinalUseDateForItem(e).getTime()+864e5*e.durationDays)}}let x=new M}}]);